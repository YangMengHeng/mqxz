{"remainingRequest":"E:\\project\\lamp-web-master\\node_modules\\babel-loader\\lib\\index.js!E:\\project\\lamp-web-master\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!E:\\project\\lamp-web-master\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\project\\lamp-web-master\\src\\components\\Tinymce\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\project\\lamp-web-master\\src\\components\\Tinymce\\index.vue","mtime":1679380940000},{"path":"E:\\project\\lamp-web-master\\babel.config.js","mtime":1679380940000},{"path":"E:\\project\\lamp-web-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1686711136315},{"path":"E:\\project\\lamp-web-master\\node_modules\\babel-loader\\lib\\index.js","mtime":1686711137609},{"path":"E:\\project\\lamp-web-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1686711136315},{"path":"E:\\project\\lamp-web-master\\node_modules\\vue-loader\\lib\\index.js","mtime":1686711137115}],"contextDependencies":[],"result":["\"use strict\";\n\nvar _interopRequireDefault = require(\"E:/project/lamp-web-master/node_modules/@babel/runtime/helpers/interopRequireDefault.js\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nrequire(\"core-js/modules/web.dom.iterable\");\nrequire(\"core-js/modules/es6.number.constructor\");\nvar _EditorImage = _interopRequireDefault(require(\"./components/EditorImage\"));\nvar _plugins = _interopRequireDefault(require(\"./plugins\"));\nvar _toolbar = _interopRequireDefault(require(\"./toolbar\"));\nvar _dynamicLoadScript = _interopRequireDefault(require(\"./dynamicLoadScript\"));\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\n/**\n * docs:\n * https://panjiachen.github.io/vue-element-admin-site/feature/component/rich-editor.html#tinymce\n */\n\n// why use this cdn, detail see https://github.com/PanJiaChen/tinymce-all-in-one\nvar tinymceCDN = 'https://cdn.jsdelivr.net/npm/tinymce-all-in-one@4.9.3/tinymce.min.js';\nvar _default2 = {\n  name: 'Tinymce',\n  components: {\n    editorImage: _EditorImage.default\n  },\n  props: {\n    id: {\n      type: String,\n      default: function _default() {\n        return 'vue-tinymce-' + +new Date() + ((Math.random() * 1000).toFixed(0) + '');\n      }\n    },\n    value: {\n      type: String,\n      default: ''\n    },\n    toolbar: {\n      type: Array,\n      required: false,\n      default: function _default() {\n        return [];\n      }\n    },\n    menubar: {\n      type: String,\n      default: 'file edit insert view format table'\n    },\n    height: {\n      type: [Number, String],\n      required: false,\n      default: 360\n    },\n    width: {\n      type: [Number, String],\n      required: false,\n      default: 'auto'\n    }\n  },\n  data: function data() {\n    return {\n      hasChange: false,\n      hasInit: false,\n      tinymceId: this.id,\n      fullscreen: false,\n      languageTypeList: {\n        'en': 'en',\n        'zh': 'zh_CN',\n        'es': 'es_MX',\n        'ja': 'ja'\n      }\n    };\n  },\n  computed: {\n    language: function language() {\n      return this.languageTypeList[this.$store.state.setting.language];\n    },\n    containerWidth: function containerWidth() {\n      var width = this.width;\n      if (/^[\\d]+(\\.[\\d]+)?$/.test(width)) {\n        // matches `100`, `'100'`\n        return \"\".concat(width, \"px\");\n      }\n      return width;\n    }\n  },\n  watch: {\n    value: function value(val) {\n      var _this2 = this;\n      if (!this.hasChange && this.hasInit) {\n        this.$nextTick(function () {\n          return window.tinymce.get(_this2.tinymceId).setContent(val || '');\n        });\n      }\n    },\n    language: function language() {\n      var _this3 = this;\n      this.destroyTinymce();\n      this.$nextTick(function () {\n        return _this3.initTinymce();\n      });\n    }\n  },\n  mounted: function mounted() {\n    this.init();\n  },\n  activated: function activated() {\n    if (window.tinymce) {\n      this.initTinymce();\n    }\n  },\n  deactivated: function deactivated() {\n    this.destroyTinymce();\n  },\n  destroyed: function destroyed() {\n    this.destroyTinymce();\n  },\n  methods: {\n    init: function init() {\n      var _this4 = this;\n      // dynamic load tinymce from cdn\n      (0, _dynamicLoadScript.default)(tinymceCDN, function (err) {\n        if (err) {\n          _this4.$message.error(err.message);\n          return;\n        }\n        _this4.initTinymce();\n      });\n    },\n    initTinymce: function initTinymce() {\n      var _this5 = this;\n      var _this = this;\n      window.tinymce.init({\n        language: this.language,\n        selector: \"#\".concat(this.tinymceId),\n        height: this.height,\n        body_class: 'panel-body ',\n        object_resizing: false,\n        toolbar: this.toolbar.length > 0 ? this.toolbar : _toolbar.default,\n        menubar: this.menubar,\n        plugins: _plugins.default,\n        end_container_on_empty_block: true,\n        powerpaste_word_import: 'clean',\n        code_dialog_height: 450,\n        code_dialog_width: 1000,\n        advlist_bullet_styles: 'square',\n        advlist_number_styles: 'default',\n        imagetools_cors_hosts: ['www.tinymce.com', 'codepen.io'],\n        default_link_target: '_blank',\n        link_title: false,\n        nonbreaking_force_tab: true,\n        // inserting nonbreaking space &nbsp; need Nonbreaking Space Plugin\n        init_instance_callback: function init_instance_callback(editor) {\n          if (_this.value) {\n            editor.setContent(_this.value);\n          }\n          _this.hasInit = true;\n          editor.on('NodeChange Change KeyUp SetContent', function () {\n            _this5.hasChange = true;\n            _this5.$emit('input', editor.getContent());\n          });\n        },\n        setup: function setup(editor) {\n          editor.on('FullscreenStateChanged', function (e) {\n            _this.fullscreen = e.state;\n          });\n        } // 整合七牛上传\n        // images_dataimg_filter(img) {\n        //   setTimeout(() => {\n        //     const $image = $(img);\n        //     $image.removeAttr('width');\n        //     $image.removeAttr('height');\n        //     if ($image[0].height && $image[0].width) {\n        //       $image.attr('data-wscntype', 'image');\n        //       $image.attr('data-wscnh', $image[0].height);\n        //       $image.attr('data-wscnw', $image[0].width);\n        //       $image.addClass('wscnph');\n        //     }\n        //   }, 0);\n        //   return img\n        // },\n        // images_upload_handler(blobInfo, success, failure, progress) {\n        //   progress(0);\n        //   const token = _this.$store.getters.token;\n        //   getToken(token).then(response => {\n        //     const url = response.data.qiniu_url;\n        //     const formData = new FormData();\n        //     formData.append('token', response.data.qiniu_token);\n        //     formData.append('key', response.data.qiniu_key);\n        //     formData.append('file', blobInfo.blob(), url);\n        //     upload(formData).then(() => {\n        //       success(url);\n        //       progress(100);\n        //     })\n        //   }).catch(err => {\n        //     failure('出现未知问题，刷新页面，或者联系程序员')\n        //     console.log(err);\n        //   });\n        // },\n      });\n    },\n    destroyTinymce: function destroyTinymce() {\n      var tinymce = window.tinymce.get(this.tinymceId);\n      if (this.fullscreen) {\n        tinymce.execCommand('mceFullScreen');\n      }\n      if (tinymce) {\n        tinymce.destroy();\n      }\n    },\n    setContent: function setContent(value) {\n      window.tinymce.get(this.tinymceId).setContent(value || '');\n    },\n    getContent: function getContent() {\n      return window.tinymce.get(this.tinymceId).getContent();\n    },\n    imageSuccessCBK: function imageSuccessCBK(arr) {\n      var _this = this;\n      arr.forEach(function (v) {\n        window.tinymce.get(_this.tinymceId).insertContent(\"<img class=\\\"wscnph\\\" src=\\\"\".concat(v.url, \"\\\" >\"));\n      });\n    }\n  }\n};\nexports.default = _default2;",{"version":3,"names":["_EditorImage","_interopRequireDefault","require","_plugins","_toolbar","_dynamicLoadScript","tinymceCDN","_default2","name","components","editorImage","props","id","type","String","default","_default","Date","Math","random","toFixed","value","toolbar","Array","required","menubar","height","Number","width","data","hasChange","hasInit","tinymceId","fullscreen","languageTypeList","computed","language","$store","state","setting","containerWidth","test","concat","watch","val","_this2","$nextTick","window","tinymce","get","setContent","_this3","destroyTinymce","initTinymce","mounted","init","activated","deactivated","destroyed","methods","_this4","load","err","$message","error","message","_this5","_this","selector","body_class","object_resizing","length","plugins","end_container_on_empty_block","powerpaste_word_import","code_dialog_height","code_dialog_width","advlist_bullet_styles","advlist_number_styles","imagetools_cors_hosts","default_link_target","link_title","nonbreaking_force_tab","init_instance_callback","editor","on","$emit","getContent","setup","e","execCommand","destroy","imageSuccessCBK","arr","forEach","v","insertContent","url","exports"],"sources":["src/components/Tinymce/index.vue"],"sourcesContent":["<template>\n  <div :class=\"{fullscreen:fullscreen}\" :style=\"{width:containerWidth}\" class=\"tinymce-container\">\n    <textarea :id=\"tinymceId\" class=\"tinymce-textarea\" />\n    <div class=\"editor-custom-btn-container\">\n      <editorImage @successCBK=\"imageSuccessCBK\" class=\"editor-upload-btn\" color=\"#1890ff\" />\n    </div>\n  </div>\n</template>\n\n<script>\n/**\n * docs:\n * https://panjiachen.github.io/vue-element-admin-site/feature/component/rich-editor.html#tinymce\n */\nimport editorImage from './components/EditorImage'\nimport plugins from './plugins'\nimport toolbar from './toolbar'\nimport load from './dynamicLoadScript'\n\n// why use this cdn, detail see https://github.com/PanJiaChen/tinymce-all-in-one\nconst tinymceCDN = 'https://cdn.jsdelivr.net/npm/tinymce-all-in-one@4.9.3/tinymce.min.js'\n\nexport default {\n  name: 'Tinymce',\n  components: { editorImage },\n  props: {\n    id: {\n      type: String,\n      default: function () {\n        return 'vue-tinymce-' + +new Date() + ((Math.random() * 1000).toFixed(0) + '')\n      }\n    },\n    value: {\n      type: String,\n      default: ''\n    },\n    toolbar: {\n      type: Array,\n      required: false,\n      default () {\n        return []\n      }\n    },\n    menubar: {\n      type: String,\n      default: 'file edit insert view format table'\n    },\n    height: {\n      type: [Number, String],\n      required: false,\n      default: 360\n    },\n    width: {\n      type: [Number, String],\n      required: false,\n      default: 'auto'\n    }\n  },\n  data () {\n    return {\n      hasChange: false,\n      hasInit: false,\n      tinymceId: this.id,\n      fullscreen: false,\n      languageTypeList: {\n        'en': 'en',\n        'zh': 'zh_CN',\n        'es': 'es_MX',\n        'ja': 'ja'\n      }\n    }\n  },\n  computed: {\n    language () {\n      return this.languageTypeList[this.$store.state.setting.language]\n    },\n    containerWidth () {\n      const width = this.width\n      if (/^[\\d]+(\\.[\\d]+)?$/.test(width)) { // matches `100`, `'100'`\n        return `${width}px`\n      }\n      return width\n    }\n  },\n  watch: {\n    value (val) {\n      if (!this.hasChange && this.hasInit) {\n        this.$nextTick(() =>\n          window.tinymce.get(this.tinymceId).setContent(val || ''))\n      }\n    },\n    language () {\n      this.destroyTinymce()\n      this.$nextTick(() => this.initTinymce())\n    }\n  },\n  mounted () {\n    this.init()\n  },\n  activated () {\n    if (window.tinymce) {\n      this.initTinymce()\n    }\n  },\n  deactivated () {\n    this.destroyTinymce()\n  },\n  destroyed () {\n    this.destroyTinymce()\n  },\n  methods: {\n    init () {\n      // dynamic load tinymce from cdn\n      load(tinymceCDN, (err) => {\n        if (err) {\n          this.$message.error(err.message)\n          return\n        }\n        this.initTinymce()\n      })\n    },\n    initTinymce () {\n      const _this = this\n      window.tinymce.init({\n        language: this.language,\n        selector: `#${this.tinymceId}`,\n        height: this.height,\n        body_class: 'panel-body ',\n        object_resizing: false,\n        toolbar: this.toolbar.length > 0 ? this.toolbar : toolbar,\n        menubar: this.menubar,\n        plugins: plugins,\n        end_container_on_empty_block: true,\n        powerpaste_word_import: 'clean',\n        code_dialog_height: 450,\n        code_dialog_width: 1000,\n        advlist_bullet_styles: 'square',\n        advlist_number_styles: 'default',\n        imagetools_cors_hosts: ['www.tinymce.com', 'codepen.io'],\n        default_link_target: '_blank',\n        link_title: false,\n        nonbreaking_force_tab: true, // inserting nonbreaking space &nbsp; need Nonbreaking Space Plugin\n        init_instance_callback: editor => {\n          if (_this.value) {\n            editor.setContent(_this.value)\n          }\n          _this.hasInit = true\n          editor.on('NodeChange Change KeyUp SetContent', () => {\n            this.hasChange = true\n            this.$emit('input', editor.getContent())\n          })\n        },\n        setup (editor) {\n          editor.on('FullscreenStateChanged', (e) => {\n            _this.fullscreen = e.state\n          })\n        }\n        // 整合七牛上传\n        // images_dataimg_filter(img) {\n        //   setTimeout(() => {\n        //     const $image = $(img);\n        //     $image.removeAttr('width');\n        //     $image.removeAttr('height');\n        //     if ($image[0].height && $image[0].width) {\n        //       $image.attr('data-wscntype', 'image');\n        //       $image.attr('data-wscnh', $image[0].height);\n        //       $image.attr('data-wscnw', $image[0].width);\n        //       $image.addClass('wscnph');\n        //     }\n        //   }, 0);\n        //   return img\n        // },\n        // images_upload_handler(blobInfo, success, failure, progress) {\n        //   progress(0);\n        //   const token = _this.$store.getters.token;\n        //   getToken(token).then(response => {\n        //     const url = response.data.qiniu_url;\n        //     const formData = new FormData();\n        //     formData.append('token', response.data.qiniu_token);\n        //     formData.append('key', response.data.qiniu_key);\n        //     formData.append('file', blobInfo.blob(), url);\n        //     upload(formData).then(() => {\n        //       success(url);\n        //       progress(100);\n        //     })\n        //   }).catch(err => {\n        //     failure('出现未知问题，刷新页面，或者联系程序员')\n        //     console.log(err);\n        //   });\n        // },\n      })\n    },\n    destroyTinymce () {\n      const tinymce = window.tinymce.get(this.tinymceId)\n      if (this.fullscreen) {\n        tinymce.execCommand('mceFullScreen')\n      }\n\n      if (tinymce) {\n        tinymce.destroy()\n      }\n    },\n    setContent (value) {\n      window.tinymce.get(this.tinymceId).setContent(value || '')\n    },\n    getContent () {\n      return window.tinymce.get(this.tinymceId).getContent()\n    },\n    imageSuccessCBK (arr) {\n      const _this = this\n      arr.forEach(v => {\n        window.tinymce.get(_this.tinymceId).insertContent(`<img class=\"wscnph\" src=\"${v.url}\" >`)\n      })\n    }\n  }\n}\n</script>\n\n<style scoped>\n.tinymce-container {\n  position: relative;\n  line-height: normal;\n}\n.tinymce-container >>> .mce-fullscreen {\n  z-index: 10000;\n}\n.tinymce-textarea {\n  visibility: hidden;\n  z-index: -1;\n}\n.editor-custom-btn-container {\n  position: absolute;\n  right: 4px;\n  top: 4px;\n  /*z-index: 2005;*/\n}\n.fullscreen .editor-custom-btn-container {\n  z-index: 10000;\n  position: fixed;\n}\n.editor-upload-btn {\n  display: inline-block;\n}\n</style>\n"],"mappings":"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"}]}