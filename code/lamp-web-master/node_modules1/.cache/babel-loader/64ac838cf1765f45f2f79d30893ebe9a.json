{"remainingRequest":"E:\\project\\lamp-web1(原版)\\lamp-web-master\\node_modules\\thread-loader\\dist\\cjs.js!E:\\project\\lamp-web1(原版)\\lamp-web-master\\node_modules\\babel-loader\\lib\\index.js!E:\\project\\lamp-web1(原版)\\lamp-web-master\\src\\api\\AxiosApi.js","dependencies":[{"path":"E:\\project\\lamp-web1(原版)\\lamp-web-master\\src\\api\\AxiosApi.js","mtime":1679380940000},{"path":"E:\\project\\lamp-web1(原版)\\lamp-web-master\\babel.config.js","mtime":1679380940000},{"path":"E:\\project\\lamp-web1(原版)\\lamp-web-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1686711136315},{"path":"E:\\project\\lamp-web1(原版)\\lamp-web-master\\node_modules\\thread-loader\\dist\\cjs.js","mtime":1686711135008},{"path":"E:\\project\\lamp-web1(原版)\\lamp-web-master\\node_modules\\babel-loader\\lib\\index.js","mtime":1686711137609}],"contextDependencies":[],"result":["import \"core-js/modules/es7.object.get-own-property-descriptors\";\nimport \"core-js/modules/es6.object.keys\";\nimport \"core-js/modules/es7.object.entries\";\nimport \"core-js/modules/web.dom.iterable\";\nimport _defineProperty from \"E:/project/lamp-web1(\\u539F\\u7248)/lamp-web-master/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";\nimport \"core-js/modules/es7.array.includes\";\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\nimport axios from 'axios';\nimport { Message, MessageBox } from 'element-ui';\nimport db from '@/utils/localstorage';\nimport router from '@/router/index';\nimport { Base64 } from 'js-base64';\n\n// 请求添加条件，如token\naxios.interceptors.request.use(function (config) {\n  var isToken = config.headers['X-isToken'] === false ? config.headers['X-isToken'] : true;\n  var token = db.get('TOKEN', '');\n  if (token && isToken) {\n    config.headers.token = 'Bearer ' + token;\n  }\n  var isTenant = config.headers['X-isTenant'] === false ? config.headers['X-isTenant'] : true;\n  if (isTenant && process.env.VUE_APP_IS_MULTI_TENANT_TYPE !== \"NONE\") {\n    config.headers.tenant = db.get('TENANT', '');\n  }\n  var clientId = process.env.VUE_APP_CLIENT_ID;\n  var clientSecret = process.env.VUE_APP_CLIENT_SECRET;\n  config.headers['Authorization'] = \"Basic \".concat(Base64.encode(\"\".concat(clientId, \":\").concat(clientSecret)));\n\n  // 当前请求地址#号后的路径，需要用户后台判断该页面的数据权限\n\n  config.headers['Path'] = router && router.history && router.history.current ? router.history.current.fullPath : '';\n\n  // 灰度参数，后台服务集群启动时，可以通过该参数固定请求某个节点！\n  config.headers['gray_version'] = 'zuihou';\n  return config;\n}, function (error) {\n  return Promise.reject(error);\n});\n\n// 接口返回处理\naxios.interceptors.response.use(function (response) {\n  return response;\n}, function (error) {\n  return Promise.reject(error);\n});\nfunction handleError(error, reject, opts) {\n  debugger;\n  var isAlert = opts.custom ? opts.custom['isAlert'] : true;\n  isAlert = isAlert === undefined ? true : isAlert;\n  if (isAlert) {\n    if (error.code === 'ECONNABORTED') {\n      Message({\n        message: '请求超时'\n      });\n    } else if (error.response && error.response.data) {\n      var resData = error.response.data;\n      if (error.response.status === 403 || error.response.status === 401) {\n        MessageBox.alert(resData.msg || '登录已失效，请重新登录', '提醒', {\n          confirmButtonText: '确定',\n          callback: function callback() {\n            db.clear();\n            window.location.hash = '/login';\n          }\n        });\n      } else if (error.response.status === 500) {\n        Message({\n          message: error.response.data\n        });\n      } else {\n        var _resData = error.response.data;\n        if (_resData.code === 40000 || _resData.code === 40001 || _resData.code === 40002 || _resData.code === 40003 || _resData.code === 40005 || _resData.code === 40006 || _resData.code === 40008 || _resData.code === 40009) {\n          MessageBox.alert(_resData.msg || _resData.message, '提醒', {\n            confirmButtonText: '确定',\n            callback: function callback() {\n              db.clear();\n              window.location.hash = '/login';\n            }\n          });\n        } else if (_resData.msg) {\n          Message({\n            message: _resData.msg\n          });\n        } else if (_resData.message) {\n          Message({\n            message: _resData.message\n          });\n        }\n      }\n    } else if (error.message) {\n      Message({\n        message: error.message\n      });\n    }\n  }\n  reject(error);\n}\nfunction handleSuccess(res, resolve, opts) {\n  var isAlert = opts.custom ? opts.custom['isAlert'] : true;\n  isAlert = isAlert === undefined ? true : isAlert;\n  var resData = res.data;\n  if (resData.isSuccess === false) {\n    // 未登录\n    if (resData.code === 40000 || resData.code === 40001 || resData.code === 40002 || resData.code === 40003 || resData.code === 40005 || resData.code === 40006 || resData.code === 40008) {\n      debugger;\n      MessageBox.alert(resData.msg, '提醒', {\n        confirmButtonText: '确定',\n        callback: function callback() {\n          window.location.hash = '/login';\n        }\n      });\n    } else {\n      if (isAlert) {\n        Message.error(resData.msg);\n      }\n    }\n  }\n  resolve(res);\n}\n\n// http请求\nvar httpServer = function httpServer(opts) {\n  // 公共参数\n  var publicParams = {\n    ts: Date.now()\n  };\n\n  // http默认配置\n  var method = opts.method.toUpperCase();\n  // baseURL\n  // 开发环境： /api                 // 开发环境在 vue.config.js 中有 devServer.proxy 代理\n  // 生产环境： http://IP:PORT/api   // 生产环境中 代理失效， 故需要配置绝对路径\n  var httpDefaultOpts = {\n    method: method,\n    baseURL: process.env.VUE_APP_PROD_REQUEST_DOMAIN_PREFIX + process.env.VUE_APP_BASE_API,\n    url: opts.url,\n    responseType: opts.responseType || '',\n    timeout: opts.custom && opts.custom['timeout'] || 30000\n  };\n  if (opts['meta']) {\n    httpDefaultOpts.headers = opts['meta'];\n  }\n  var dataRequest = ['PUT', 'POST', 'DELETE', 'PATCH'];\n  if (dataRequest.includes(method)) {\n    httpDefaultOpts.data = opts.data || {};\n    httpDefaultOpts.params = publicParams;\n  } else {\n    httpDefaultOpts.params = _objectSpread(_objectSpread({}, publicParams), opts.data || {});\n  }\n\n  // formData转换\n  if (opts.formData) {\n    httpDefaultOpts.transformRequest = [function (data) {\n      var formData = new FormData();\n      if (data) {\n        Object.entries(data).forEach(function (item) {\n          formData.append(item[0], item[1]);\n        });\n      }\n      return formData;\n    }];\n  }\n  var promise = new Promise(function (resolve, reject) {\n    axios(httpDefaultOpts).then(function (response) {\n      handleSuccess(response, resolve, opts);\n    }).catch(function (error) {\n      handleError(error, reject, opts);\n    });\n  });\n  return promise;\n};\nexport default httpServer;",null]}